{% extends 'base.html' %}

{% block title %}Social Media Posts - AI Agent MVP{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Social Media Posts</h1>
    <div class="actions">
        <a href="{{ url_for('social.index') }}" class="btn primary">Create New Post</a>
    </div>
</div>

<!-- Filters -->
<section class="card filter-card">
    <h3>Filter Posts</h3>
    <form action="{{ url_for('social.list_posts') }}" method="get" class="filter-form">
        <div class="filter-group">
            <label for="platform">Platform</label>
            <select id="platform" name="platform" onchange="this.form.submit()">
                <option value="all" {% if current_platform == 'all' %}selected{% endif %}>All Platforms</option>
                {% for platform in platforms %}
                <option value="{{ platform }}" {% if current_platform == platform %}selected{% endif %}>
                    {{ platform|capitalize }}
                </option>
                {% endfor %}
            </select>
        </div>
        
        <div class="filter-group">
            <label for="status">Status</label>
            <select id="status" name="status" onchange="this.form.submit()">
                <option value="all" {% if current_status == 'all' %}selected{% endif %}>All Statuses</option>
                {% for status in statuses %}
                <option value="{{ status }}" {% if current_status == status %}selected{% endif %}>
                    {{ status|capitalize }}
                </option>
                {% endfor %}
            </select>
        </div>
        
        <button type="submit" class="btn small">Apply Filters</button>
        <a href="{{ url_for('social.list_posts') }}" class="btn small">Clear Filters</a>
    </form>
</section>

<!-- Posts List -->
<section class="card">
    {% if posts|length > 0 %}
    <table class="posts-table">
        <thead>
            <tr>
                <th>Platform</th>
                <th>Content</th>
                <th>Created</th>
                <th>Schedule/Published</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for post in posts %}
            <tr>
                <td>
                    <span class="platform-badge {{ post.platform.value }}">
                        {{ post.platform.value|capitalize }}
                    </span>
                </td>
                <td class="content-cell">
                    <div class="truncate-text">{{ post.content }}</div>
                    {% if post.hashtags %}
                    <div class="post-hashtags small">
                        {% for tag in post.hashtags %}
                        <span class="hashtag">#{{ tag }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </td>
                <td>
                    {{ post.created_at.strftime('%Y-%m-%d') if post.created_at is not string else post.created_at[:10] }}
                </td>
                <td>
                    {% if post.is_scheduled and post.scheduled_at %}
                    <span class="scheduled-time">
                        {{ post.scheduled_at.strftime('%Y-%m-%d %H:%M') if post.scheduled_at is not string else post.scheduled_at[:16].replace('T', ' ') }}
                    </span>
                    {% elif post.is_published and post.published_at %}
                    <span class="published-time">
                        {{ post.published_at.strftime('%Y-%m-%d %H:%M') if post.published_at is not string else post.published_at[:16].replace('T', ' ') }}
                    </span>
                    {% else %}
                    <span>-</span>
                    {% endif %}
                </td>
                <td>
                    <span class="status-badge {{ post.status.value }}">
                        {{ post.status.value|capitalize }}
                    </span>
                </td>
                <td class="actions">
                    <a href="{{ url_for('social.preview', post_id=post.id) }}" class="btn small">View/Edit</a>
                    {% if post.is_draft %}
                    <form method="post" action="{{ url_for('social.publish', post_id=post.id) }}" style="display: inline;">
                        <button type="submit" class="btn small primary">Publish</button>
                    </form>
                    {% endif %}
                    <form method="post" action="{{ url_for('social.delete', post_id=post.id) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this post?');">
                        <button type="submit" class="btn small danger">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <p>No social media posts have been generated yet.</p>
        <a href="{{ url_for('social.index') }}" class="btn primary">Create Your First Post</a>
    </div>
    {% endif %}
</section>
{% endblock %}

{% block head %}
<style>
    .filter-card {
        margin-bottom: 20px;
    }
    
    .filter-form {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        align-items: flex-end;
    }
    
    .filter-group {
        flex: 1;
        min-width: 200px;
    }
    
    .filter-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: 500;
    }
    
    .filter-group select {
        width: 100%;
        padding: 8px 12px;
    }
    
    .platform-badge {
        display: inline-block;
        padding: 5px 10px;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: 600;
        color: white;
    }
    
    .platform-badge.twitter {
        background-color: #1DA1F2;
    }
    
    .platform-badge.facebook {
        background-color: #4267B2;
    }
    
    .platform-badge.instagram {
        background-color: #C13584;
    }
    
    .platform-badge.linkedin {
        background-color: #0077B5;
    }
    
    .status-badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.75rem;
        font-weight: 600;
    }
    
    .status-badge.draft {
        background-color: var(--warning-color);
        color: var(--dark-color);
    }
    
    .status-badge.scheduled {
        background-color: var(--info-color);
        color: white;
    }
    
    .status-badge.published {
        background-color: var(--success-color);
        color: white;
    }
    
    .status-badge.failed {
        background-color: var(--danger-color);
        color: white;
    }
    
    .content-cell {
        max-width: 300px;
    }
    
    .truncate-text {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 100%;
    }
    
    .post-hashtags.small {
        margin-top: 4px;
        font-size: 0.75rem;
    }
    
    .hashtag {
        color: var(--primary-color);
        margin-right: 5px;
    }
    
    .scheduled-time, .published-time {
        font-size: 0.85rem;
    }
    
    .scheduled-time {
        color: var(--info-color);
    }
    
    .published-time {
        color: var(--success-color);
    }
</style>
{% endblock %}

